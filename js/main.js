const sidebarFn=()=>{const e=document.getElementById("toggle-menu"),t=document.getElementById("sidebar-menus"),o=document.getElementById("menu-mask"),n=document.body;function s(){n.style.overflow="",n.style.paddingRight="",utils.fadeOut(o,.5),t.classList.remove("open")}e.addEventListener("click",(function(){utils.sidebarPaddingR(),n.style.overflow="hidden",utils.fadeIn(o,.5),t.classList.add("open")})),o.addEventListener("click",(e=>{t.classList.contains("open")&&s()})),window.addEventListener("resize",(o=>{utils.isHidden(e)&&t.classList.contains("open")&&s(),sco.refreshWaterFall()}))},scrollFn=function(){const e=window.innerHeight;if(document.body.scrollHeight<=e)return;let t=0;const o=document.getElementById("page-header"),n=utils.throttle((function(e){initThemeColor();const n=window.scrollY||document.documentElement.scrollTop,s=function(e){const o=e>t;return t=e,o}(n);n>0?(s?o.classList.contains("nav-visible")&&o.classList.remove("nav-visible"):o.classList.contains("nav-visible")||o.classList.add("nav-visible"),o.classList.add("nav-fixed")):o.classList.remove("nav-fixed","nav-visible")}),200);window.addEventListener("scroll",(function(e){n(e),0===window.scrollY&&o.classList.remove("nav-fixed","nav-visible")}))},percent=()=>{const e=document.documentElement,t=document.body,o=window.pageYOffset||e.scrollTop,n=Math.max(t.scrollHeight,e.scrollHeight,t.offsetHeight,e.offsetHeight,t.clientHeight,e.clientHeight),s=e.clientHeight,c=n-s,l=Math.round(o/c*100),i=document.querySelector("#nav-totop"),a=document.querySelector("#percent"),d=document.getElementById("post-comment")||document.getElementById("footer");window.scrollY+s>=d.offsetTop||l>90?(i.classList.add("long"),a.textContent=GLOBAL_CONFIG.lang.backtop):(i.classList.remove("long"),a.textContent=l);document.querySelectorAll(".needEndHide").forEach((e=>e.classList.toggle("hide",c-o<100))),window.onscroll=percent},handleThemeChange=e=>{const t=(window.globalFn||{}).themeChange||{};t&&Object.keys(t).forEach((o=>{(0,t[o])(e)}))},showTodayCard=()=>{const e=document.getElementById("todayCard"),t=document.getElementsByClassName("topGroup")[0];e&&t&&t.addEventListener("mouseleave",(()=>{e.classList.remove("hide")}))},initObserver=()=>{let e=document.getElementById("post-comment"),t=document.getElementById("pagination");if(e&&t){new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting?(t.classList.add("show-window"),GLOBAL_CONFIG.comment.commentBarrage&&(document.querySelector(".comment-barrage").style.bottom="-200px")):(t.classList.remove("show-window"),GLOBAL_CONFIG.comment.commentBarrage&&(document.querySelector(".comment-barrage").style.bottom="0px"))}))})).observe(e)}};class toc{static init(){const e=document.getElementById("card-toc");if(!e||!e.querySelector(".toc a"))return void(e.style.display="none");const t=document.querySelectorAll(".toc a");t.forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),utils.scrollToDest(utils.getEleTop(document.getElementById(decodeURI(("toc-text"===e.target.className?e.target.parentNode.hash:e.target.hash).replace("#","")))),300)}))})),this.active(t)}static active(e){const t=document.getElementById("article-container"),o=document.getElementById("toc-content"),n=t.querySelectorAll("h1,h2,h3,h4,h5,h6");let s="";function c(t){if(0===t)return!1;let c="";if(n.forEach((function(e,o){t>utils.getEleTop(e)-80&&(c=o)})),s===c)return;s=c,document.querySelectorAll(".toc .active").forEach((e=>{e.classList.remove("active")}));const l=e[s];if(l){let t=e[s].parentNode;for(l.classList.add("active"),function(e){const t=e.getBoundingClientRect().top,n=o.scrollTop;t>document.documentElement.clientHeight-100&&(o.scrollTop=n+150),t<100&&(o.scrollTop=n-150)}(l);!t.matches(".toc");t=t.parentNode)t.matches("li")&&t.classList.add("active")}}window.tocScrollFn=utils.throttle((function(){c(window.scrollY||document.documentElement.scrollTop)}),100),window.addEventListener("scroll",tocScrollFn)}}let lastSayHello="",wleelw_musicPlaying=!1,is_rm="undefined"!=typeof rm,sco={hideCookie:function(){setTimeout((()=>{const e=document.getElementById("cookies-window");e&&(e.classList.add("cw-hide"),setTimeout((()=>{e.style.display="none"}),1e3))}),3e3)},scrollTo:function(e){const t=document.getElementById(e);if(t){const e=t.getBoundingClientRect().top+window.pageYOffset-80,o=window.pageYOffset,n=e-o;let s=null;window.requestAnimationFrame((function e(t){s=s||t;const c=t-s,l=Math.min(c/0,1),i=l<.5?2*l*l:(4-2*l)*l-1;window.scrollTo(0,o+n*i),c<600&&window.requestAnimationFrame(e)}))}},musicToggle:function(){const e=document.querySelector("#nav-music"),t=document.querySelector("meting-js"),o=document.getElementById("consoleMusic"),n=document.querySelector("#menu-music-toggle span"),s=document.querySelector("#menu-music-toggle i");wleelw_musicPlaying=!wleelw_musicPlaying,e.classList.toggle("playing",wleelw_musicPlaying),o.classList.toggle("on",wleelw_musicPlaying),wleelw_musicPlaying?(t.aplayer.play(),rm?.menuItems.music[0]&&(n.textContent=GLOBAL_CONFIG.right_menu.music.stop)&&(s.className="solitude st-pause-fill")):(t.aplayer.pause(),rm?.menuItems.music[0]&&(n.textContent=GLOBAL_CONFIG.right_menu.music.start)&&(s.className="solitude st-play-fill"))},switchCommentBarrage:function(){let e=document.querySelector(".comment-barrage");e&&("flex"===window.getComputedStyle(e).display?(e.style.display="none",document.querySelector("#consoleCommentBarrage").classList.remove("on"),utils.saveToLocal.set("commentBarrageSwitch",!1,.2),rm?.menuItems.barrage&&rm.barrage(!0)):(e.style.display="flex",document.querySelector("#consoleCommentBarrage").classList.add("on"),utils.saveToLocal.set("commentBarrageSwitch",!0,.2),rm?.menuItems.barrage&&rm.barrage(!1)))},switchHideAside:function(){const e=document.documentElement.classList;e.contains("hide-aside")?utils.saveToLocal.set("aside-status","show",1):utils.saveToLocal.set("aside-status","hide",1),e.toggle("hide-aside"),e.contains("hide-aside")?document.querySelector("#consoleHideAside").classList.add("on"):document.querySelector("#consoleHideAside").classList.remove("on")},switchKeyboard:function(){sco_keyboards=!sco_keyboards;const e=document.querySelector("#consoleKeyboard");sco_keyboards?(e.classList.add("on"),openKeyboard(),localStorage.setItem("keyboard",!0)):(closeKeyboard(),e.classList.remove("on"),localStorage.setItem("keyboard",!1),document.getElementById("keyboard-tips")?.classList.remove("show"))},initConsoleState:function(){document.documentElement.classList.contains("hide-aside")?document.querySelector("#consoleHideAside").classList.add("on"):document.querySelector("#consoleHideAside").classList.remove("on")},changeSayHelloText:function(){const e=GLOBAL_CONFIG.aside.sayhello2,t=document.getElementById("author-info__sayhi");let o=e[Math.floor(Math.random()*e.length)];for(;o===lastSayHello;)o=e[Math.floor(Math.random()*e.length)];t.textContent=o,lastSayHello=o},switchDarkMode:function(){let e="dark"===document.documentElement.getAttribute("data-theme")?"dark":"light";"light"===e?(document.documentElement.setAttribute("data-theme","dark"),utils.saveToLocal.set("theme","dark",.02),utils.snackbarShow(GLOBAL_CONFIG.lang.theme.dark,!1,2e3),is_rm&&rm.mode(!0)):(document.documentElement.setAttribute("data-theme","light"),utils.saveToLocal.set("theme","light",.02),utils.snackbarShow(GLOBAL_CONFIG.lang.theme.light,!1,2e3),is_rm&&rm.mode(!1)),handleThemeChange(e)},hideTodayCard:()=>document.getElementById("todayCard").classList.add("hide"),toTop:()=>utils.scrollToDest(0),showConsole:function(){let e=document.getElementById("console");e&&!e.classList.contains("show")&&e.classList.add("show")},hideConsole:function(){const e=document.getElementById("console");e&&e.classList.remove("show")},refreshWaterFall:function(){const e=document.querySelectorAll(".waterfall");0!==e.length&&e.forEach((e=>waterfall(e)||e.classList.add("show")))},addRuntime:function(){let e=document.getElementById("runtimeshow");e&&GLOBAL_CONFIG.runtime&&(e.innerText=utils.timeDiff(new Date(GLOBAL_CONFIG.runtime),new Date)+GLOBAL_CONFIG.lang.time.day)},toTalk:function(e){const t=["#wl-edit",".el-textarea__inner","#veditor",".atk-textarea"];for(let o=0;o<t.length;o++){let n=document.querySelector(t[o]);null!=n&&(n.dispatchEvent(new Event("input",{bubble:!0,cancelable:!0})),n.value="> "+e.replace(/\n/g,"\n> ")+"\n\n",utils.scrollToDest(utils.getEleTop(document.getElementById("post-comment")),300),n.focus(),n.setSelectionRange(-1,-1))}utils.snackbarShow(GLOBAL_CONFIG.lang.totalk,!1,2e3)},initbbtalk:function(){if(document.querySelector("#bber-talk")){new Swiper(".swiper-container",{direction:"vertical",loop:!0,autoplay:{delay:3e3,pauseOnMouseEnter:!0}})}},addPhotoFigcaption:function(){document.querySelectorAll("#article-container img").forEach((e=>{const t=e.parentNode,o=e.getAttribute("alt");if(o){const n=document.createElement("div");n.className="img-alt is-center",n.textContent=o,t.insertBefore(n,e.nextSibling)}}))},scrollToComment:function(){utils.scrollToDest(utils.getEleTop(document.getElementById("post-comment")),300)},setTimeState:function(){const e=document.getElementById("author-info__sayhi");if(e){const t=(new Date).getHours(),o=GLOBAL_CONFIG.aside.sayhello,n=[{start:0,end:5,text:o.goodnight},{start:6,end:10,text:o.morning},{start:11,end:14,text:o.noon},{start:15,end:18,text:o.afternoon},{start:19,end:24,text:o.night}];for(let o of n)if(t>=o.start&&t<=o.end){e.innerText=o.text;break}}},tagPageActive:function(){const e=window.location.pathname,t=decodeURIComponent(e);if(/\/tags\/.*?\//.test(t)){const e=t.split("/").slice(-2,-1)[0];if(document.getElementById("#tag-page-tags")){document.querySelectorAll("a").forEach((e=>{e.classList.remove("select")}));const t=document.getElementById(e);t&&t.classList.add("select")}}},categoriesBarActive:function(){const e=document.querySelector("#category-bar"),t=window.location.pathname,o=decodeURIComponent(t);if(e){if(document.querySelectorAll(".category-bar-item").forEach((e=>{e.classList.remove("select")})),"/"===o){document.getElementById("category-bar-home").classList.add("select")}else if(/\/categories\/.*?\//.test(o)){let e=o.split("/").slice(-2,-1)[0];e=e.charAt(0).toUpperCase()+e.slice(1);const t=document.getElementById(e);t&&t.classList.add("select")}}},scrollCategoryBarToRight:function(){let e,t=document.getElementById("category-bar-items"),o=document.getElementById("category-bar-next"),n=t.clientWidth;t&&(t.scrollLeft+t.clientWidth>=t.scrollWidth-8?t.scroll({left:0,behavior:"smooth"}):t.scrollBy({left:n,behavior:"smooth"}),t.addEventListener("scroll",(function n(){clearTimeout(e),e=setTimeout((function(){t.scrollLeft+t.clientWidth>=t.scrollWidth-8?o.style.transform="rotate(180deg)":o.style.transform="",t.removeEventListener("scroll",n)}),150)})))},openAllTags:function(){document.querySelectorAll(".card-allinfo .card-tag-cloud").forEach((function(e){e.classList.add("all-tags")}));let e=document.getElementById("more-tags-btn");e&&e.parentNode.removeChild(e)},listenToPageInputPress:function(){const e=document.getElementById("toPageText"),t=document.getElementById("toPageButton");if(!e)return;const o=document.querySelectorAll(".page-number");if(1===+o[o.length-1].textContent){const e=document.querySelector(".toPageGroup");e&&e.remove()}e.addEventListener("keydown",(e=>{13===e.keyCode&&(sco.toPage(),pjax.loadUrl(t.href))})),e.addEventListener("input",(()=>{""===e.value||"0"===e.value?t.classList.remove("haveValue"):t.classList.add("haveValue");const o=document.querySelectorAll(".page-number"),n=+o[o.length-1].textContent;+e.value>n&&(e.value=n)}))},addNavBackgroundInit:function(){let e=0,t=0;document.body&&(e=document.body.scrollTop),document.documentElement&&(t=document.documentElement.scrollTop),0!==(e-t>0?e:t)&&(document.getElementById("page-header").classList.add("nav-fixed"),document.getElementById("page-header").classList.add("nav-visible"));const o=document.getElementById("cookies-window");o&&(o.style.display="none")},topPostScroll:function(){if(document.getElementById("recent-post-top")){let e=document.getElementById("recent-post-top");e.addEventListener("mousewheel",(function(t){e.scrollLeft+=-t.wheelDelta/2,document.body.clientWidth<1200&&t.preventDefault()}),{passive:!1})}},initAdjust:function(e=!1){const t=document.getElementById("site-name");let o=t&&t.offsetWidth;const n=document.querySelector("#menus .menus_items");let s=n&&n.offsetWidth;const c=document.querySelector("#search-button");let l=c&&c.offsetWidth;e&&(o=t&&t.offsetWidth,s=n&&n.offsetWidth,l=c&&c.offsetWidth);const i=document.getElementById("nav");let a;a=window.innerWidth<768||o+s+l>i?.offsetWidth-120,a?i?.classList.add("hide-menu"):i?.classList.remove("hide-menu"),document.getElementById("nav")?.classList.add("show")},toPage:function(){const e=document.querySelectorAll(".page-number"),t=parseInt(e[e.length-1].innerHTML),o=document.getElementById("toPageText"),n=parseInt(o.value);if(!isNaN(n)&&n>0&&n<=t){const e=window.location.href.replace(/\/page\/\d+\/$/,"/");let t;t=1===n?e:e+(e.endsWith("/")?"":"/")+"page/"+n+"/",document.getElementById("toPageButton").href=t}},owoBig(e){let t=document.getElementById("owo-big");t||(t=document.createElement("div"),t.id="owo-big",document.body.appendChild(t));document.addEventListener("mouseover",((e,t)=>{let o;return function(...n){clearTimeout(o),o=setTimeout((()=>{clearTimeout(o),e(...n)}),t)}})((o=>{const n=o.target,s=n.closest(e.item);if(s&&n.closest(e.body)){const e=s.querySelector("img")?.src;e&&(t.innerHTML=`<img src="${e}" style="max-width: 100%; height: auto;">`,t.style.display="block",function(e){const o=e.getBoundingClientRect();t.style.left=o.left-t.offsetWidth/4+"px",t.style.top=`${o.top}px`}(s))}}),100)),document.addEventListener("mouseout",(o=>{o.target.closest(e.item)&&o.target.closest(e.body)&&(t.style.display="none")}))},changeTimeFormat(e){e.forEach((e=>{const t=e.getAttribute("datetime");e.textContent=utils.diffDate(t,!0),e.style.display="inline"}))},switchComments(){const e=document.getElementById("switch-btn");if(!e)return;let t=!1;const o=document.getElementById("post-comment");utils.addEventListenerPjax(e,"click",(()=>{o.classList.toggle("move"),t||"function"!=typeof loadTwoComment||(t=!0,loadTwoComment())}))}};const addHighlight=()=>{const e=GLOBAL_CONFIG.highlight;if(!e)return;const{copy:t,expand:o,limit:n,syntax:s}=e,c="prismjs"===s,l=e.enable||t||o||n,i=!0==!o?"closed":"",a="highlight.js"===s?document.querySelectorAll("figure.highlight"):document.querySelectorAll('pre[class*="language-"]');if(!l&&!n||!a.length)return;const d=t?'<i class="solitude st-copy-fill copy-button"></i>':"<i></i>",r=n?'<i class="solitude st-show-line"></i>':"<i></i>",m=(e,t)=>{utils.snackbarShow(t,!1,2e3)},u=e=>{const t=e.parentNode;t.classList.add("copy-true");const o=window.getSelection(),n=document.createRange(),s=c?"pre code":"table .code pre";n.selectNodeContents(t.querySelectorAll(`${s}`)[0]),o.removeAllRanges(),o.addRange(n),e.lastChild,document.queryCommandSupported&&document.queryCommandSupported("copy")?(document.execCommand("copy"),m(0,GLOBAL_CONFIG.lang.copy.success)):m(0,GLOBAL_CONFIG.lang.copy.error),o.removeAllRanges(),t.classList.remove("copy-true")},g=function(){this.classList.toggle("expand-done")},h=function(e){const t=e.target.classList;t.contains("expand")?(e=>{e.classList.toggle("closed")})(this):t.contains("copy-button")&&u(this)},y=(e,t,o)=>{const s=document.createDocumentFragment();if(l){const t=document.createElement("div");t.className=`highlight-tools ${i}`,t.innerHTML='<i class="solitude st-arrow-down expand"></i>'+e+d,utils.addEventListenerPjax(t,"click",h),s.appendChild(t)}if(n&&t.offsetHeight>n+30){const e=document.createElement("div");e.className="code-expand-btn",e.innerHTML=r,utils.addEventListenerPjax(e,"click",g),s.appendChild(e)}"hl"===o?t.insertBefore(s,t.firstChild):t.parentNode.insertBefore(s,t)};c?a.forEach((e=>{const t=`<div class="code-lang">${e.getAttribute("data-language")||"Code"}</div>`;utils.wrap(e,"figure",{class:"highlight"}),y(t,e)})):a.forEach((e=>{let t=e.getAttribute("class").split(" ")[1];"plain"!==t&&void 0!==t||(t="Code");y(`<div class="code-lang">${t}</div>`,e,"hl")}))},addCopyright=()=>{if(!GLOBAL_CONFIG.copyright)return;const{limit:e,author:t,link:o,source:n,info:s}=GLOBAL_CONFIG.copyright;document.body.addEventListener("copy",(c=>{c.preventDefault();const l=window.getSelection(0).toString();let i=l;return l.length>e&&(i=`${l}\n\n${t}\n${o}${window.location.href}\n${n}\n${s}`),c.clipboardData?c.clipboardData.setData("text",i):window.clipboardData.setData("text",i)}))},asideStatus=()=>{const e=utils.saveToLocal.get("aside-status");void 0!==e&&("hide"===e?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"))};class tabs{static init(){this.clickFnOfTabs(),this.backToTop()}static clickFnOfTabs(){document.querySelectorAll("#article-container .tab > button").forEach((function(e){e.addEventListener("click",(function(e){const t=this,o=t.parentNode;if(!o.classList.contains("active")){const e=o.parentNode.nextElementSibling,n=utils.siblings(o,".active")[0];n&&n.classList.remove("active"),o.classList.add("active");const s=t.getAttribute("data-href").replace("#","");[...e.children].forEach((e=>{e.id===s?e.classList.add("active"):e.classList.remove("active")}))}}))}))}static backToTop(){document.querySelectorAll("#article-container .tabs .tab-to-top").forEach((function(e){e.addEventListener("click",(function(){utils.scrollToDest(utils.getEleTop(e.parentElement.parentElement.parentNode),300)}))}))}}window.refreshFn=()=>{document.body.setAttribute("data-type",PAGE_CONFIG.page),PAGE_CONFIG.is_home||PAGE_CONFIG.is_page?(sco.changeTimeFormat(document.querySelectorAll("#recent-posts time, .webinfo-item time")),GLOBAL_CONFIG.runtime&&sco.addRuntime()):sco.changeTimeFormat(document.querySelectorAll("#post-meta time")),scrollFn(),sidebarFn(),sco.hideCookie(),sco.addPhotoFigcaption(),sco.setTimeState(),sco.tagPageActive(),sco.categoriesBarActive(),sco.listenToPageInputPress(),sco.addNavBackgroundInit(),sco.refreshWaterFall(),GLOBAL_CONFIG.lazyload.enable&&utils.lazyloadImg(),GLOBAL_CONFIG.lightbox&&utils.lightbox(document.querySelectorAll("#article-container img:not(.flink-avatar,.gallery-group img)")),GLOBAL_CONFIG.randomlink&&randomLinksList(),PAGE_CONFIG.toc&&toc.init(),(PAGE_CONFIG.is_post||PAGE_CONFIG.is_page)&&(addHighlight()||tabs.init()),PAGE_CONFIG.is_home&&showTodayCard(),GLOBAL_CONFIG.covercolor.enable&&coverColor(),"music"===PAGE_CONFIG.page&&scoMusic.init(),GLOBAL_CONFIG.post_ai&&PAGE_CONFIG.is_post&&efu_ai.init(),sco.switchComments(),sco.topPostScroll()},document.addEventListener("DOMContentLoaded",(function(){sco.initAdjust(),initObserver(),addCopyright(),sco.initConsoleState(),window.refreshFn(),asideStatus(),percent()})),window.onkeydown=function(e){(123===e.keyCode||17===e.ctrlKey&&16===e.shiftKey&&67===e.keyCode)&&utils.snackbarShow(GLOBAL_CONFIG.lang.f12,!1,3e3),27===e.keyCode&&sco.hideConsole()},document.addEventListener("copy",(()=>utils.snackbarShow(GLOBAL_CONFIG.lang.copy.success,!1,3e3)));